---
title: "{{< iconify ph heart >}} Interests"
format: html
---

```{r}
#| include: false
library(dashboardr)
```

```{=html}
<style>
/* Ensure chart containers expand to fit content - aggressive overrides */
.cell-output-display,
.cell-output,
.panel-tabset-tabby > .tab-content,
.panel-tabset > .tab-content,
.tab-pane,
.tab-pane.active,
.card-body,
.quarto-figure,
section {
  overflow: visible !important;
  height: auto !important;
  max-height: none !important;
}
/* Ensure highcharts containers respect their set height */
.highcharts-container,
.html-widget,
.htmlwidget {
  overflow: visible !important;
}
</style>
<script>
// Aggressive reflow for Highcharts - multiple attempts to catch widget initialization
(function() {
  function reflowCharts() {
    if (typeof Highcharts !== 'undefined' && Highcharts.charts) {
      Highcharts.charts.forEach(function(chart) {
        if (chart) {
          try { chart.reflow(); } catch(e) {}
        }
      });
    }
  }
  
  // Try multiple times at different intervals
  [0, 100, 250, 500, 1000, 2000].forEach(function(delay) {
    setTimeout(function() {
      window.dispatchEvent(new Event('resize'));
      requestAnimationFrame(reflowCharts);
    }, delay);
  });
  
  // Also reflow on any tab click
  document.addEventListener('click', function(e) {
    if (e.target.matches('.nav-link, [data-bs-toggle="tab"]')) {
      setTimeout(reflowCharts, 50);
    }
  });
})();
</script>
```

## Interest & Behavior Targeting

This page reveals which interests, behaviors, and audience segments advertisers target most heavily. These targeting options allow campaigns to reach specific voter segments based on their online activity and preferences.

**Use the search box** below to find specific interests or behaviors.


```{r, echo=FALSE, results='asis'}
dashboardr::enable_inputs()
```

```{r setup}
#| echo: false
#| warning: false
#| message: false
#| error: false
#| results: 'hide'

# Load required libraries
library(dashboardr)
library(dplyr)
library(highcharter)

# Global chunk options
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  error = FALSE,
  fig.width = 12,
  fig.height = 8,
  dpi = 300
)

# Load data
data <- readRDS('dataset_small_50obs.rds')

# Data summary
cat('Dataset loaded:', nrow(data), 'rows,', ncol(data), 'columns\n')

```


```{r}
#| echo: false
#| results: 'asis'
dashboardr::render_value_box_row(list(
  list(
    title = "Interests Targeted",
    value = "50",
    bg_color = "#2563eb",
    logo_url = NULL,
    logo_text = NULL
  ),
  list(
    title = "Top Interest",
    value = "Political science",
    bg_color = "#7c3aed",
    logo_url = NULL,
    logo_text = NULL
  ),
  list(
    title = "Advertisers Using",
    value = "54",
    bg_color = "#0891b2",
    logo_url = NULL,
    logo_text = NULL
  )
))
```


```{r}
#| echo: false
#| results: 'asis'
dashboardr::render_input_row(list(
  list(
    input_id = "interest_search",
    label = "Search Interests:",
    type = "text",
    filter_var = "interest",
    options = NULL,
    options_from = NULL,
    default_selected = NULL,
    placeholder = "Select...",
    width = "300px",
    min = 0,
    max = 100,
    step = 1,
    value = NULL,
    show_value = TRUE,
    inline = TRUE,
    toggle_series = NULL,
    override = FALSE,
    labels = NULL,
    size = "md",
    help = NULL,
    disabled = FALSE,
    mt = NULL,
    mr = NULL,
    mb = NULL,
    ml = NULL
  )
), style = "boxed", align = "center")
```

## Interest & Behavior Targeting Analysis

```{r bar-interest}
# Interest & Behavior Targeting Analysis
result <- create_bar(
  data = data,
  title = "Interest & Behavior Targeting Analysis",
  horizontal = TRUE,
  x_var = "interest",
  weight_var = "spend",
  subtitle = "Top 50 interests and behaviors being targeted. Shows what audience segments advertisers prioritize most.",
  y_label = "Ad Spend (USD)",
  tooltip_prefix = "ðŸŽ¯ Interest Spend: $",
  tooltip_suffix = " targeting this interest/behavior",
  color_palette = "#7c3aed"
)

result
```

